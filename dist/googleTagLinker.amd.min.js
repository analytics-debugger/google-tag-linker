/*!
* 
*   @analytics-debugger/google-tag-linker 0.0.1
*   https://github.com/analytics-debugger/google-tag-linker
*
*   Copyright (c) David Vallejo (https://www.thyngster.com).
*   This source code is licensed under the MIT license found in the
*   LICENSE file in the root directory of this source tree.
*
*/

define((function(){"use strict";function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,o,i,a,s=[],c=!0,f=!1;try{if(i=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;c=!1}else for(;!(c=(t=i.call(n)).done)&&(s.push(t.value),s.length!==r);c=!0);}catch(e){f=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(f)throw o}}return s}}(e,r)||n(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,r){if(e){if("string"==typeof e)return o(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,r):void 0}}function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"get",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{conversionLinkerCookiesPrefix:"_gcl",gaCookiesPrefix:"",linkerQueryParameterName:"_gl",checkFingerPrint:!1};if("undefined"==typeof window||void 0===window.document)throw"This should be only run on a browser";switch(e){case"get":return u({gaCookiesPrefix:r.gaCookiesPrefix,conversionLinkerCookiesPrefix:r.conversionLinkerCookiesPrefix,cookiesNamesList:r.cookiesNamesList});case"read":return l({gaCookiesPrefix:r.gaCookiesPrefix,conversionLinkerCookiesPrefix:r.conversionLinkerCookiesPrefix,linkerQueryParameterName:r.linkerQueryParameterName,cookiesNamesList:r.cookiesNamesList,checkFingerPrint:r.checkFingerPrint});case"decorate":return g()}};function a(e){for(var r=("; "+document.cookie).split("; "),n=r.length-1;n>=0;n--){var t=r[n].split("=");if(e instanceof RegExp?e.test(t[0]):e===t[0])return[t[0],t[1]]}return[]}function s(e,r){return[e,window.btoa(r).replace(/=/g,".")].join("*")}function c(e){return window.atob(e.replace(/\./g,"="))}function f(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.gaCookiesPrefix,o=n.conversionLinkerCookiesPrefix,i=n.cookiesNamesList;i=i||[t+"_ga",new RegExp("^"+t+"_ga_[A-Z,0-9]")].concat(r(["_aw","_dc","_gb","_gf","_ha"].map((function(e){return o+e}))),["FPLC"]);var c=[],f=void 0;return i.forEach((function(r){var n,t=e(a(r),2);r=t[0],(n=t[1])&&(/^_ga/.test(r)?n=n.match(/G[A-Z]1\.[0-9]\.(.+)/)[1]:"FPLC"===r&&(f=n),c.push(s(r,n)))})),f&&c.push(s("_fplc",f)),c}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.gaCookiesPrefix,n=e.conversionLinkerCookiesPrefix,t=e.cookiesNamesList,o=f({gaCookiesPrefix:r,conversionLinkerCookiesPrefix:n,cookiesNamesList:t});return["1",v(o),o.join("*")].join("*")}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.gaCookiesPrefix,n=e.conversionLinkerCookiesPrefix,t=e.linkerQueryParameterName,o=e.cookiesNamesList,i=e.checkFingerPrint;function a(e){var r=window.location.href,n=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(r);return null===n?null:decodeURIComponent(n[1])}var s={},u=a(t);if(u){if(i){var l=u.split("*")[1],g=f({gaCookiesPrefix:r,conversionLinkerCookiesPrefix:n,cookiesNamesList:o}),k=v(g);if(l!==k)return}for(var m=u.split("*").slice(2),d=0;d<m.length;d+=2){var h=m[d],y=m[d+1];s[h]=c(y)}return s}}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.gaCookiesPrefix,n=e.conversionLinkerCookiesPrefix,o=e.cookiesNamesList,i=e.linkerQueryParameterName,a=e.entity,s=e.useFragment;function c(e,r,n,o){a.href&&(e=l(e,r,n.href,void 0!==o&&o),t.test(e)&&(n.href=e))}function f(e,r,n){if(n&&n.action){var o=(n.method||"").toLowerCase();if("get"===o){o=n.childNodes||[];for(var i=!1,a=0;a<o.length;a++){var s=o[a];if(s.name===e){s.setAttribute("value",r),i=!0;break}}i||((o=z.createElement("input")).setAttribute("type","hidden"),o.setAttribute("name",e),o.setAttribute("value",r),n.appendChild(o))}else"post"===o&&(e=l(e,r,n.action),t.test(e)&&(n.action=e))}}function l(e,r,n,t){function o(r){var n=(r=U(e,r)).charAt(r.length-1);return r&&"&"!==n&&(r+="&"),r+s}t=void 0!==t&&t;var i=fa.exec(n);if(!i)return"";n=i[1];var a=i[2]||"";i=i[3]||"";var s=e+"="+r;return t?i="#"+o(i.substring(1)):a="?"+o(a.substring(1)),""+n+a+i}var g=u({gaCookiesPrefix:r,conversionLinkerCookiesPrefix:n,cookiesNamesList:o});if(a.tagName){if("a"===a.tagName.toLowerCase())return c(i,g,a,s);if("form"===a.tagName.toLowerCase())return f(i,g,a)}if("string"==typeof a)return l(i,g,a,s)}function v(){for(var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=[window.navigator.userAgent,(new Date).getTimezoneOffset(),window.navigator.userLanguage||window.navigator.language,Math.floor((new Date).getTime()/60/1e3)-0,r?r.join("*"):""].join("*"),t=[],o=0;o<256;o++){e=o;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[o]=e}for(var a=-1,s=0;s<n.length;s++)a=a>>>8^t[255&(a^n.charCodeAt(s))];return((-1^a)>>>0).toString(36)}return i.prototype={},i.answer=42,i}));
