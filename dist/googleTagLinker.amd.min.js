/*!
* 
*   @analytics-debugger/google-tag-linker 0.0.1
*   https://github.com/analytics-debugger/google-tag-linker
*
*   Copyright (c) David Vallejo (https://www.thyngster.com).
*   This source code is licensed under the MIT license found in the
*   LICENSE file in the root directory of this source tree.
*
*/

define((function(){"use strict";var e=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function r(e){for(var r=("; "+document.cookie).split("; "),i=r.length-1;i>=0;i--){var t=r[i].split("=");if(e instanceof RegExp?e.test(t[0]):e===t[0])return[t[0],t[1]]}return[]}function i(e,r){return[e,window.btoa(r).replace(/=/g,".")].join("*")}function t(e){return window.atob(e.replace(/\./g,"="))}function n(e){var r=window.location.href,i=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(r);return null===i?null:decodeURIComponent(i[1])}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.linkerQueryParameterName,i=e.checkFingerPrint,o=n(r);if(o){for(var a=o.split("*").slice(2),s={},u=[],c=0;c<a.length;c+=2){var g=a[c],m=a[c+1];u.push(g+"*"+m),s[g]=t(m)}if(i){var k=f(u),v=o.split("*")[1];if(v!==k)return}return s}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cookiesNamesList,n=e.gaCookiesPrefix,o=new RegExp("^"+n+"_ga"),a=[],s=void 0;return Array.isArray(t)?t.forEach((function(e){var t=r(e);e=t[0];var n=t[1];if(n){if(o.test(e))n=n.match(/G[A-Z]1\.[0-9]\.(.+)/)[1];else if("FPLC"===e)return void(s=n);a.push(i(e,n))}})):Object.keys(t).forEach((function(e){var r=t[e];"FPLC"!==e?a.push(i(e,r)):s=r})),s&&a.push(i("_fplc",s)),a}function s(r,i,t,n){if(t&&t.href){var o=c(r,i,t.href,n);if(e.test(o))return t.href=o,t}}function u(r,i,t){if(t&&t.action){var n=(t.method||"").toLowerCase();if("get"===n){for(var o=t.childNodes||[],a=!1,s=0;s<o.length;s++){var u=o[s];if(u.name===r){u.setAttribute("value",i),a=!0;break}}if(!a){var f=document.createElement("input");f.setAttribute("type","hidden"),f.setAttribute("name",r),f.setAttribute("value",i),t.appendChild(f)}return t}if("post"===n){var g=c(r,i,t.action);if(e.test(g))return t.action=g,t}}}function c(e,r,i,t){function n(r){var i=(r=function(e,r){if(e=function(e){return new RegExp("(.*?)(^|&)"+e+"=([^&]*)&?(.*)")}(e).exec(r)){var i=e[2],t=e[4];r=e[1],t&&(r=r+i+t)}return r}(e,r)).charAt(r.length-1);return r&&"&"!==i&&(r+="&"),r+c}t=!!t;var o=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(i);if(!o)return"";var a=o[1],s=o[2]||"",u=o[3]||"",c=e+"="+r;return t?u="#"+n(u.substring(1)):s="?"+n(s.substring(1)),""+a+s+u}function f(){for(var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=[window.navigator.userAgent,(new Date).getTimezoneOffset(),window.navigator.userLanguage||window.navigator.language,Math.floor((new Date).getTime()/60/1e3)-0,r?r.join("*"):""].join("*"),t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}for(var a=-1,s=0;s<i.length;s++)a=a>>>8^t[255&(a^i.charCodeAt(s))];return((-1^a)>>>0).toString(36)}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.cookiesNamesList,i=e.gaCookiesPrefix,t=a({cookiesNamesList:r,gaCookiesPrefix:i});return["1",f(t),t.join("*")].join("*")}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.linkerQueryParameterName,i=e.checkFingerPrint;return o({linkerQueryParameterName:r,checkFingerPrint:i})}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.linkerQueryParameterName,i=e.cookiesNamesList,t=e.gaCookiesPrefix,n=e.entity,o=e.useFragment,a=g({cookiesNamesList:i,gaCookiesPrefix:t});if(n.tagName){if("A"===n.tagName)return s(r,a,n,o);if("FORM"===n.tagName)return u(r,a,n)}if("string"==typeof n)return c(r,a,n,o)}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"get",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"==typeof window||void 0===window.document)throw"This should be only run on a browser";var i={gaCookiesPrefix:r.gaCookiesPrefix||"",conversionLinkerCookiesPrefix:r.conversionLinkerCookiesPrefix||"_gcl",linkerQueryParameterName:r.linkerQueryParameterName||"_gl",checkFingerPrint:!!r.checkFingerPrint||!1,useFragment:!!r.useFragment||!1};switch(r.cookiesNamesList?i.cookiesNamesList=r.cookiesNamesList:(i.cookiesNamesList=[i.gaCookiesPrefix+"_ga",new RegExp("^"+i.gaCookiesPrefix+"_ga_[A-Z,0-9]"),"FPLC"],["_aw","_dc","_gb","_gf","_ha"].forEach((function(e){i.cookiesNamesList.push(i.conversionLinkerCookiesPrefix+e)}))),e){case"get":return g({cookiesNamesList:i.cookiesNamesList,gaCookiesPrefix:i.gaCookiesPrefix});case"read":return m({linkerQueryParameterName:i.linkerQueryParameterName,checkFingerPrint:i.checkFingerPrint});case"decorate":return k({linkerQueryParameterName:i.linkerQueryParameterName,cookiesNamesList:i.cookiesNamesList,entity:r.entity,useFragment:i.useFragment})}};return v.prototype={},v.answer=42,v}));
